{"ast":null,"code":"import React,{useState,useEffect}from'react';import Map from'../components/Map';// Ajustez le chemin relatif selon le besoin\nimport{ResponsiveContainer,BarChart,Bar,Tooltip,YAxis,XAxis,PieChart,Pie,Cell}from'recharts';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const COLORS=['#12274B','#005a8e','#2A7ABF','#4C97D2'];const Home=()=>{const[data,setData]=useState([]);const[selectedRegion,setSelectedRegion]=useState(null);const[selectedCityData,setSelectedCityData]=useState(null);const[chartTitle,setChartTitle]=useState('en France');const center=[46.2276,2.2137];// Coordonnées pour centrer la carte sur la France\nconst zoom=6;// Niveau de zoom ajusté pour voir toute la France\nconst fetchData=async(url,title)=>{try{const response=await axios.get(url);const ageDistribution=response.data;const totalPopulation=ageDistribution.femmes_65_79+ageDistribution.femmes_80_plus+ageDistribution.hommes_65_79+ageDistribution.hommes_80_plus;const chartData=[{name:\"F(65-79)\",total:ageDistribution.femmes_65_79,percentage:ageDistribution.femmes_65_79/totalPopulation*100},{name:\"F(80+)\",total:ageDistribution.femmes_80_plus,percentage:ageDistribution.femmes_80_plus/totalPopulation*100},{name:\"H(65-79)\",total:ageDistribution.hommes_65_79,percentage:ageDistribution.hommes_65_79/totalPopulation*100},{name:\"H(80+)\",total:ageDistribution.hommes_80_plus,percentage:ageDistribution.hommes_80_plus/totalPopulation*100}];setData(chartData);setChartTitle(title);}catch(error){console.error('Error fetching data:',error);setData([]);}};useEffect(()=>{fetchData('http://localhost:4000/api/age-distribution','en France');// Charger les données de toute la France au montage\n},[]);const handleRegionClick=region=>{setSelectedRegion(region);setSelectedCityData(null);// Reset city selection\nfetchData(\"http://localhost:4000/api/age-distribution/\".concat(region),\"en \".concat(region));};const handleCityClick=cityData=>{setSelectedCityData(cityData);const totalPopulation=cityData.femmes_65_79+cityData.femmes_80_plus+cityData.hommes_65_79+cityData.hommes_80_plus;const chartData=[{name:\"F(65-79)\",total:cityData.femmes_65_79,percentage:cityData.femmes_65_79/totalPopulation*100},{name:\"F(80+)\",total:cityData.femmes_80_plus,percentage:cityData.femmes_80_plus/totalPopulation*100},{name:\"H(65-79)\",total:cityData.hommes_65_79,percentage:cityData.hommes_65_79/totalPopulation*100},{name:\"H(80+)\",total:cityData.hommes_80_plus,percentage:cityData.hommes_80_plus/totalPopulation*100}];setData(chartData);setChartTitle('dans le rayon de 50km');};return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"home-content\",children:[/*#__PURE__*/_jsx(Map,{center:center,zoom:zoom,onRegionClick:handleRegionClick,onCityClick:handleCityClick}),/*#__PURE__*/_jsxs(\"div\",{className:\"charts\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart-container\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Nombre homme et femme par tranche d'\\xE2ge \",chartTitle]}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(BarChart,{data:data,margin:{top:20,right:30,left:20,bottom:5},children:[/*#__PURE__*/_jsx(XAxis,{dataKey:\"name\"}),/*#__PURE__*/_jsx(YAxis,{tickFormatter:value=>new Intl.NumberFormat('fr').format(value)}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"total\",fill:\"#005a8e\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-container\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"R\\xE9partition en % homme et femme par tranche d'\\xE2ge \",chartTitle]}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(PieChart,{children:[/*#__PURE__*/_jsx(Pie,{data:data,dataKey:\"percentage\",nameKey:\"name\",cx:\"50%\",cy:\"50%\",outerRadius:110,fill:\"#8884d8\",label:_ref=>{let{name,percentage}=_ref;return\"\".concat(name,\": \").concat(percentage.toFixed(2),\"%\");},children:data.map((entry,index)=>/*#__PURE__*/_jsx(Cell,{fill:COLORS[index%COLORS.length]},\"cell-\".concat(index)))}),/*#__PURE__*/_jsx(Tooltip,{})]})})]})]})]})});};export default Home;","map":{"version":3,"names":["React","useState","useEffect","Map","ResponsiveContainer","BarChart","Bar","Tooltip","YAxis","XAxis","PieChart","Pie","Cell","axios","jsx","_jsx","jsxs","_jsxs","COLORS","Home","data","setData","selectedRegion","setSelectedRegion","selectedCityData","setSelectedCityData","chartTitle","setChartTitle","center","zoom","fetchData","url","title","response","get","ageDistribution","totalPopulation","femmes_65_79","femmes_80_plus","hommes_65_79","hommes_80_plus","chartData","name","total","percentage","error","console","handleRegionClick","region","concat","handleCityClick","cityData","className","children","onRegionClick","onCityClick","width","height","margin","top","right","left","bottom","dataKey","tickFormatter","value","Intl","NumberFormat","format","fill","nameKey","cx","cy","outerRadius","label","_ref","toFixed","map","entry","index","length"],"sources":["/Users/jujupeneau/Desktop/Wildcodeschool_Data_engineer/projet/Lama_dev_login/react_simple_copy/src/pages/Home.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Map from '../components/Map'; // Ajustez le chemin relatif selon le besoin\nimport { ResponsiveContainer, BarChart, Bar, Tooltip, YAxis, XAxis, PieChart, Pie, Cell } from 'recharts';\nimport axios from 'axios';\n\nconst COLORS = ['#12274B', '#005a8e', '#2A7ABF', '#4C97D2'];\n\nconst Home = () => {\n    const [data, setData] = useState([]);\n    const [selectedRegion, setSelectedRegion] = useState(null);\n    const [selectedCityData, setSelectedCityData] = useState(null);\n    const [chartTitle, setChartTitle] = useState('en France');\n    const center = [46.2276, 2.2137]; // Coordonnées pour centrer la carte sur la France\n    const zoom = 6; // Niveau de zoom ajusté pour voir toute la France\n\n    const fetchData = async (url, title) => {\n        try {\n            const response = await axios.get(url);\n            const ageDistribution = response.data;\n\n            const totalPopulation = ageDistribution.femmes_65_79 + ageDistribution.femmes_80_plus + ageDistribution.hommes_65_79 + ageDistribution.hommes_80_plus;\n\n            const chartData = [\n                { name: \"F(65-79)\", total: ageDistribution.femmes_65_79, percentage: (ageDistribution.femmes_65_79 / totalPopulation) * 100 },\n                { name: \"F(80+)\", total: ageDistribution.femmes_80_plus, percentage: (ageDistribution.femmes_80_plus / totalPopulation) * 100 },\n                { name: \"H(65-79)\", total: ageDistribution.hommes_65_79, percentage: (ageDistribution.hommes_65_79 / totalPopulation) * 100 },\n                { name: \"H(80+)\", total: ageDistribution.hommes_80_plus, percentage: (ageDistribution.hommes_80_plus / totalPopulation) * 100 }\n            ];\n\n            setData(chartData);\n            setChartTitle(title);\n        } catch (error) {\n            console.error('Error fetching data:', error);\n            setData([]);\n        }\n    };\n\n    useEffect(() => {\n        fetchData('http://localhost:4000/api/age-distribution', 'en France'); // Charger les données de toute la France au montage\n    }, []);\n\n    const handleRegionClick = (region) => {\n        setSelectedRegion(region);\n        setSelectedCityData(null); // Reset city selection\n        fetchData(`http://localhost:4000/api/age-distribution/${region}`, `en ${region}`);\n    };\n\n    const handleCityClick = (cityData) => {\n        setSelectedCityData(cityData);\n        const totalPopulation = cityData.femmes_65_79 + cityData.femmes_80_plus + cityData.hommes_65_79 + cityData.hommes_80_plus;\n\n        const chartData = [\n            { name: \"F(65-79)\", total: cityData.femmes_65_79, percentage: (cityData.femmes_65_79 / totalPopulation) * 100 },\n            { name: \"F(80+)\", total: cityData.femmes_80_plus, percentage: (cityData.femmes_80_plus / totalPopulation) * 100 },\n            { name: \"H(65-79)\", total: cityData.hommes_65_79, percentage: (cityData.hommes_65_79 / totalPopulation) * 100 },\n            { name: \"H(80+)\", total: cityData.hommes_80_plus, percentage: (cityData.hommes_80_plus / totalPopulation) * 100 }\n        ];\n\n        setData(chartData);\n        setChartTitle('dans le rayon de 50km');\n    };\n\n    return (\n        <div className=\"home\">\n            <div className=\"home-content\">\n                <Map center={center} zoom={zoom} onRegionClick={handleRegionClick} onCityClick={handleCityClick} />\n                <div className=\"charts\">\n                    <div className=\"chart-container\">\n                        <h2>\n                            Nombre homme et femme par tranche d'âge {chartTitle}\n                        </h2>\n                        <ResponsiveContainer width=\"100%\" height={300}>\n                            <BarChart data={data} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>\n                                <XAxis dataKey=\"name\" />\n                                <YAxis tickFormatter={(value) => new Intl.NumberFormat('fr').format(value)} />\n                                <Tooltip />\n                                <Bar dataKey=\"total\" fill=\"#005a8e\" />\n                            </BarChart>\n                        </ResponsiveContainer>\n                    </div>\n                    <div className=\"chart-container\">\n                        <h2>\n                            Répartition en % homme et femme par tranche d'âge {chartTitle}\n                        </h2>\n                        <ResponsiveContainer width=\"100%\" height={300}>\n                            <PieChart>\n                                <Pie\n                                    data={data}\n                                    dataKey=\"percentage\"\n                                    nameKey=\"name\"\n                                    cx=\"50%\"\n                                    cy=\"50%\"\n                                    outerRadius={110}\n                                    fill=\"#8884d8\"\n                                    label={({ name, percentage }) => `${name}: ${percentage.toFixed(2)}%`}\n                                >\n                                    {data.map((entry, index) => (\n                                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                                    ))}\n                                </Pie>\n                                <Tooltip />\n                            </PieChart>\n                        </ResponsiveContainer>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default Home;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}